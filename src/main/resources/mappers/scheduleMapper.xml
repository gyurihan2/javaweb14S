<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spring.javaweb14S.dao.ScheduleDAO">
<!-- Select -->
	<!-- 달력에 표시할 스케줄 리스트 -->
	<select id="getSchduleList" resultType="scheduleVO">
		select a.*,
		(select name from theater where idx=a.theaterIdx) as theaterName, 
		(select title from movie where idx=a.movieIdx) as movieTitle 
		from schedule as a where playDate like concat(#{requestDate},'%') group by (theaterIdx);
	</select>
	
	<!-- 해당일의 스케줄 리스트 -->
	<select id="getSchduleDateList" resultType="scheduleVO">
		select a.*,
		(select name from theater where idx=a.theaterIdx) as theaterName, 
		(select title from movie where idx=a.movieIdx) as movieTitle,
		(select main_poster from movie where idx=a.movieIdx) as main_poster
		from schedule as a 
		where playDate =#{selectDate} order by theaterName, screenOrder;
	</select>
	
	
	
<!-- Insert -->
	<!-- 상영관 추가 -->
	<insert id="setScheduleInput" parameterType="java.util.List">
		insert into schedule values
		<foreach collection="vos" item="vo" separator=",">
		(default,#{vo.theaterIdx},#{vo.groupId},#{vo.playDate},#{vo.movieIdx},#{vo.screenOrder},#{vo.playTime},DATE_ADD(concat(#{vo.playDate},' ',#{vo.playTime}), INTERVAL #{vo.runtime} MINUTE),#{vo.leftSeat},default)
		</foreach>
	</insert>

	
	
		
<!-- Update -->
	
	
	
	
<!-- Delete -->
	


</mapper>